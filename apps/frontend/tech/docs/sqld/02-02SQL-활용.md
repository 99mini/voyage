---
sidebar_position: 3
slug: sqld-SQL-활용
title: '2과목: 제2장 SQL 활용'
authors: [99mini]
tags: [sqld, 데이터베이스]
---

SQL 활용

:::warning

작성 중

:::

<!-- truncate -->

## 서브 쿼리

- 하나의 SQL문 안에 포함되어 있는 또 다른 SQL문

### 사용 가능한 곳

- **GROUP BY** 절 사용 불가
- SELECT
- FROM
- WHERE
- HAVING
- ORDER BY

### 종류

1. 동작하는 방식에 따라

- **UN-CORRELATED SUBQUERY(비연관)**
- **CORRELATED SUBQUERY(연관)**

2. 위치에 따라

- **스칼라 서브쿼리**
  - SELECT에 사용하는 서브쿼리
  - 서브쿼리 결과를 하나의 컬럼처럼 사용

```sql title="스칼라 서브쿼리"
SELECT column_name1, expression,
  (
    SELECT column_name2 FROM table_name WHERE condition
  )
FROM table_name;
```

- **인라인 뷰**
  - FROM절에 사용
  - 서브쿼리 결과를 테이블처럼 사용

```sql title="인라인 뷰"
SELECT column_name
FROM (
  SELECT column_name2 FROM table_name2 WHERE condition
)
WHERE condition;
```

### WHERE절 서브쿼리

- 값을 전달하기 위해 사용 (상수항의 대체)

```sql title="WHERE절 서브쿼리"
SELECT column_name1
FROM table_name
WHERE condition_operator (
  SELECT column_name2 FROM table_name2 WHERE condition
);
```

1. 단일행 서브쿼리

| 연산자 | 의미        |
| ------ | ----------- |
| `=`    | 같음        |
| `<>`   | 같지 않다   |
| `<`    | 작다        |
| `>`    | 크다        |
| `<=`   | 작거나 같다 |
| `>=`   | 크거나 같다 |

```sql title="단일행 서브쿼리"
SELECT employee_name, salary
FROM employee
WHERE salary > (
  SELECT AVG(salary)
  FROM employee
);
```

2. 다중행 서브쿼리

| 연산자 | 의미    |
| ------ | ------- |
| IN     | 같은 값 |
| > ANY  | 최소값  |
| < ANY  | 최대값  |
| > ALL  | 최대값  |
| < ALL  | 최소값  |

```sql title="다중행 서브쿼리"
> ALL(2000, 3000) -- 최대값(3000)보다 큰 행 반환
< ALL(2000, 3000) -- 최소값(2000)보다 작은 행 반환
> ANY(2000, 3000) -- 최소값(2000)보다 큰 행 반환
< ANY(2000, 3000) -- 최대값(3000)보다 작은 행 반환
```

```sql title="다중행 서브쿼리 예시"

SELECT employee_name, salary
FROM employee
WHERE salary > ANY(
  SELECT salary
  FROM employee
  WHERE department_number = 10
);
```

3. 다중컬럼 서브쿼리

```sql title="다중컬럼 서브쿼리"
SELECT employee_name, salary
FROM employee
WHERE (department_number, salary) IN (
  SELECT department_number, MAX(salary)
  FROM employee
  GROUP BY department_number
)
```

4. 상호연관 서브쿼리

```sql title="상호연관 서브쿼리"
SELECT employee_name, salary, department_number
FROM employee e1
WHERE salary > (
  SELECT AVG(salary)
  FROM employee e2
  WHERE e1.department_number = e2.department_number
  GROUP BY department_number
);
```

## 집합 연산자

## 그룹 함수

## 윈도우 함수

## Top N 쿼리

## 계층형 질의와 셀프 조인

## PIVOT 절과 UNPIVOT 절

## 정규 표현식

> 최종 수정일: 2025-03-07T10:00
